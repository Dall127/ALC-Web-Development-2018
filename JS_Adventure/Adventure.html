<!DOCTYPE html>
<html>
    <head>
        <title>
        Adventure Game
        </title>
    </head>
    <body>
        <h1>Adventure Game v0.1</h1>
         <p>By: Dallin</p>
        <script>
        function remove(_array, toRemove) {
            array = _array;
            for(i = 0; i < array.length; i++) {
                if(array[i] == toRemove) {
                    array = array.splice(i, 1);
                    return array;
                }
            }
            return _toRemove
            
        }    
        var playerName = ""   
        endStatement = "You return to looking at your surroundings.";
        askStatement = ". What do you want to do?";
        var globalArray = {
            gInnArray: ["dwarf", "elf"],
            gPeople: [],
            gBNEnemies: ["black night"],
            gKBEnemies: ["Killer Bunny"],
        }
        var globalInvetory = {
            dwarf: false,
            elf: false,
            money: 0,
            wand: false,
            battleAxe: false,
            
        }
        var map = [

                     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                     [0, 0, 0, 1, 2, 1, 2, 1, 0, 0],
                     [0, 0, 0, 4, 0, 2, 0, 0, 0, 0],
                     [0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
                     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                   ];

        posx = 5;
        posy = 4;
            
        map[4][5] = Inn;
      
        map[2][5] = Town;
        map[2][3] = KillerBunny;
        map[2][7] = BlackKnight;
          
            
        function Actions(action, area, people=null, enemies=Null) {
            if(action == "fight"){
                if(enemies==null){
                    alert("There is no one here to fight. Better luck next time.");
                }
                else {
                    var response = prompt("Who do you want to fight?").toLowerCase();
                        for (i = 0; i < people.length; i++) {
                           if(response == enemies[i]) {
                               if(this.globalInvetory.wand) {
                               var random = Math.random;
                               if(random < .5) {
                                   alert("You have beaten your enemy");
                                   return "win";
                               }
                               else  {
                                   alert("Your enemy has beaten you.");
                                   return "lose";
                               }
                            }
                             else if(this.globalInvetory.battleAxe) {
                    
                }
                else {
               
                    var random = Math.random;

                    if(random < .5) {
                        alert("You have no weapons. You were able to dodge a hit");
                        return area;
                    }
                    else  {
                        alert("You haven no weapons. Your enemy however does not care. Your enemy strikes you down");
                        return "lose"
                    
                }
                           }
                            
                        }

                        
                     }
                    
                  alert("There is no-one here to fight with the name " + response + ". " + endStatement);
                  return(area);


            }
            else if action == "look" {
                return area;
            }
            else if(action == "talk") {
                if(people==null){
                    alert("There is no one here to talk to. Best be getting on");
                }
                else{
                    var response = prompt("Who do you want to talk to?").toLowerCase();
                    for (i = 0; i < people.length; i++) {
                       if(response == people[i])
                          return response; 
                        
                     
                      
                    }
                    
                  alert("There is no-one here with the name " + response + ". " +  endStatement);
                  return(area);
                }
               
            }
            else if(action == "move") {
                var direction = prompt("Which direction which you would like to move?");
                if(direction == "up") {
                    if((this.map[this.posy - 1][this.posx]) == 2) {
                          this.posy -= 2;
                        }
                    if(this.map[this.posy][this.posx] != 0 && this.map[this.posy][this.posx] != area) {
                        return this.map[this.posy][this.posx];
                    }
                    else{
                        alert("You are not able to move in that direction. " + endStatement);
                        return area;
                    }
                    
                    
                }
                if(direction == "down") {
                    if((this.map[this.posy + 1][this.posx]) == 2) {
                        this.posy += 2;
                        }
                    if(this.map[this.posy][this.posx] != 0 && this.map[this.posy][this.posx] != area) {
                        return this.map[this.posy][this.posx];
                    }
                    else{
                        alert("You are not able to move in that direction." + endStatement);
                        return area;
                    }
                 }
                if(direction == "left") {
                    
                    if((this.map[this.posy][this.posx - 1]) == 2) {
                        this.posx -= 2;
                        }
                    if(this.map[this.posy][this.posx] != 0 && this.map[this.posy][this.posx] != area) {
                        return this.map[this.posy][this.posx];
                    }
                    else{
                        alert("You are not able to move in that direction." + endStatement);
                        return this.map[this.posy][this.posx];
                    }
                }
                    if(direction == "right") {
                        if((this.map[this.posy][this.posx + 1]) == 2) {
                            this.posx += 2;
                        }
                    if(this.map[this.posy][this.posx] != 0 && this.map[this.posy][this.posx] != area) {
                        return this.map[this.posy][this.posx];
                    }
                    else{
                        alert("You are not able to move in that direction." + endStatement);
                        return area;
                    }
                }

            
        }
            else{
                alert("Not a valid option Please try again");
                return "unavalible"
                }
        }

            
        
            function start() {
                this.playerName = prompt("What is your Name?");
                alert("Welcome Sorcerer " + this.playerName + ", welcome to Detheren");
                var beginAdv = confirm("Are you ready to begin your Adventure");
          
                if(beginAdv == true) {
                    return this.map[this.posy][this.posx];
                }
                
            }
            function BlackKnight() {
                var action = prompt("After walking down the red forest for a good while, you see someone inf the distance. Walking a little further, you see a knight dressed in black. As you approach, he says to you, \"You cannot pass. I will not allow it\"");
                nextAction = Actions(action, BlackKnight, null, this.globalArray.gBNEnemies)
                if(nextAction == "win") {
                    alert("Congrats! You have won all of the fame and glory. If you want to play again, refresh after the game stops.");
                }
                else if(nextAction == "lose") {
                    alert("game over. Try again next time. If you want to play again, refresh after the game stops.");
                    return "Devious way to end the script, I'm going to throw an error";
                }
                else{
                   return nextAction 
                }
            }
            function KillerBunny() {
                var action = prompt("A bunny approaches, but you notice that it's eyes are red, and there are multiple skeltons lying around");
                nextAction = Actions(action, KillerBunny, null, this.globalArray.gKBEnemies);
                if(action == "move") {
                    return nextAction;
                }
                else if(nextAction == "win") {
                    alert("Congrats! You have won all of the fame and glory. If you want to play again, refresh after the game stops.");
                }
                else if(nextAction == "lose") {
                    alert("game over. Try again next time. If you want to play again, refresh after the game stops.");
                    return "Devious way to end the script, I'm going to throw an error";
                }
                else{
                   alert("You cannot do that here.")
                   return KillerBunny;
                }
            
            }
            function Town() {
            var action = prompt("The town seems dreary, and worn down. Two roads diverged in red forest. There really isn't much to do here but move on" + askStatement);
            var localList = [];
            if(this.globalInvetory.dwarf){
                localList.push("dwarf")
            }
            if(this.globalInvetory.elf){
                localList.push("elf")
            }
                
            nextAction = Actions(action, Town, localList);
            if(action == "move") {
                return nextAction;
            }
            else if(nextAction == "dwarf"){
                var bool = confirm('The Dwarf looks you up and down, as if he hadnt\'t already looked at you enough. After a few seconds he says, "Look laddie, your going to need a weapon. Do ye want my spare battleAxe?"');
                if(bool) {
                    this.globalInvetory.battleAxe = true;
                    alert(endStatement);
                    return Town;
                }
            
                
                
            }
            if(nextAction == "elf") {
                var bool = confirm("The elf looks around, as if he is hiding for someone, but soon seems to calm down. He then drops his snotty act and says, \"You never know who is on your side... You seem to be ill equiped for adventuring. Would you like a wand? Assuming that you can wield it...")
                if(bool) {
                    this.globalInvetory.wand = true;
                    alert(endStatement);
                    return Town;
                }
            }
            else if(nextAction == "unavalible") {
                    return town;
            }
            else {
                alert("you cannot do that here");
                return Town;
            }

            
            }
            function Inn() {
                dwarfP = " A dwarf sits off in the corner.";
                elfP = " An elf sharpens his blade on a grindstone. This seems odd to you, since you know elven steel does not dull";
                
                
            
            

                if(this.globalArray.gInnArray.length == 2) {
                    var action = prompt("You are at an inn." + dwarfP + elfP + " The smell of adventure lingers in the air. " + askStatement).toLowerCase();
                    wElf = false;
                    wDwarf = false;
                    
                }
                else{
                    if(this.globalArray.gInnArray[0] == 'dwarf') {
                        var action = prompt("You are at an inn. " + dwarfP + " The smell of adventure lingers in the air. " + askStatement).toLowerCase();
                        wDwarf = false;
                        wElf = true;

                    }
                    else{
                        var action = prompt("You are at an inn." + elfP + " The smell of adventure lingers in the air. " + askStatement).toLowerCase();
                        wDwarf = true;
                        wElf = false;
                    }
                }
                
                nextAction = Actions(action, Inn, this.globalArray.gInnArray);
                if(action == "move") {
                    return nextAction;
                }
                else if(nextAction == "dwarf") {
                    if(wElf == true) {
                        alert("The Dwarf looks at you, and seems to want to talk, but then sees the elf with you; the look of disgust is very apparent. He does not respond. " + endStatement);
                        return Inn;
                        
                        }
                    else if(wElf == false) {
                        var bool = confirm('The Dwarf looks at you, and looks you up and down, and says "Well, do you want me to join you or not');
                        if(bool) {
                            remove(this.globalArray.gInnArray, "dwarf");
                            this.globalInvetory.dwarf = true;
                            return Inn; 
                                }
                        else{
                            alert(endStatement);
                            return Inn;
                            }
                        }

                    }
                
                if(nextAction == "elf"){
                    if(wDwarf == true) {
                        alert("The Elf looks at you with blatent disguist. You don't realize why at first, but then a grunt comes from your Dwarven companion and suddenly you understand why. " + endStatement);
                        return Inn;
                    }
                    else if(wDwarf == false) {
                        var bool = confirm('The Elf looks at you with slight disgust and says "Well, do you want me to join you or not?"');
                        if(bool == true) {
                            remove(this.globalArray.gInnArray, "elf");
                            this.globalInvetory.elf = true;
                            return Inn;
                                }
                        else{
                            alert(endStatement);
                            return Inn;
                            }
                    }
                    
                }
               
                    
            
                else if(nextAction == "unavalible") {
                    return Inn;
                }
                else{
                    alert("You cannot do that here.");
                    return Inn;
                }
                 
            }
            

            var func = start();
            while(true) {
                var func = func.call();
                
            }
            
            
                    
            
                
                
            
        
        

        
        
        
        </script>
    
    
    
    
    </body>








</html>

